---
title: Cybersecurity Notes
date: '2023-04-21'
tags: ['school', 'Design']
---

# Introduction #

* Security is freedom from or resilience against potential harm caused by others.
* Cybersecurity is the practice of defending computers and electronic systems from malicious attacks, also known as information technology security or electronic information security.
* The most common attack for password access is social engineering.

## Types of Cybersecurity ##

* Application: Prevent data and code used by a business from being stolen or hijacked with penetration testing and encryption.
* Information: Prevent physical and digital data from unauthorized access and manipulation, on site and remote systems.
* Infrastructure: Make sure that structures and facilities such as the electrical grid, data centers are access controlled
* Network security: Secure internal computer networks against unauthorized access with tools like remote access management and 2FA
* Users Education: Teach every employee and customer for recognizing and avoiding malware and phishing.


**Importance**

Cybersecurity is important since it protects data from theft and damage, including sensitive data, personally identifiable information (PII), health information (PHI), intellectual property and governmental and industry systems. Attackers are no longer enthusiast but fully organized crime groups. In 2021 3.5 million positions go unfulfilled globally.

The average cost of remediating a ransomware have gone to 1.85 million (2021) from downtime, lost orders, operational costs, the ransom on crytocoins average only costs a tenth of the losses. The number of organizations that paid the ransom is also increasing to 32 percent (2021) even if less than 10 percent of the ones that pay recover all of their data. The Mexican Law of Cybersecurity is included in 211 of Codigo Penal Federal, the nation has a national guard cybercrime unit, federal law dictates personal data protection and the official cost of cyberattacks is valued at 7.7 billion dollars (2017). Sadly Mexico is the greatest producer of cp.

Un ataque de malware le cuesta a una organización 2.4 millones de dólares y 50 días para recuperarse.
Se estima que los costos relacionados con el cibercrimen en 2021 sean de aproximadamente 6 billones de dólares (6,000,000,000,000) para las organizaciones y gobiernos atacados.
 El panorama de los atacantes ha cambiado de aficionados con intenciones de descubrir y mejorar conocimientos (hackers), a organizaciones criminales con intenciones monetarias (cibercrimen).
Se estima que para 2021 habrá 3.5 millones de vacantes relacionadas a la ciberseguridad.

Se cuenta con una ley que tipifica los accesos ilícitos a sistemas y equipos de informática (211 bis).
Se tiene una estrategia nacional de ciberseguridad, así como una policía cibernética
Se tiene legislación para regular la posesión de datos personales en posesión de los particulares.
Según McKinsey, los principales retos en México son el robo de información, la afectación a infraestructura publica, la perdida de confianza y los ataques al sector financiero.
Los ataques en México en el año 2017 costaron alrededor de 7.7 miles de millones de dólares en perdidas.
México es el primer productor de pornografía infantil a nivel global, con costo aproximado en 34 miles de millones de dólares en 2014.


**Areas**

Human, organizational and regulatory aspects include risk management and governance, human factors, privacy, and laws. Threat defense includes malware protection, adversarial behaviors, digital forensics, security operations and incident management.

* Systems Security: Operating Systems, virtualization, cryptography, distributed systems security, AAA, hardware security, network security and web security.
* Software Security: Software security, lifecycle, updates and web security.
* Infrastructure Security: Cyberphysical security, physical layer, telecomms security, hardware security and network security.


### Assets 

Assets are something of value to a person, business or organization. IT assets are any element used in to add value to the organization such as:

* Software (DBMS, Office, OS, Apps)
* Hardware (Servers, routers, switches, IoT, Appliances, HVAC, PSU)
* Data (sales, domains, reports, customers, personnel, finances, code, industrial secrets)
* Other (public image, credibility, industrial secrets). 

**Security Aspects**

Confidentiality, Integrity and Availability (CIA) are the pillars of modern cybersecurity and good security systems. The pillars are considered in a system though three fundamental security aspects or levels:

* Process level: Management systems, governance, policies, 3rd party management.
	* Mission, vision, responsibilities, roles and politics that define the way that people operate.
* Data-Tech level: IT, OT, Personal Data, Operational Data.
	* Assets used to help people achieve their process objectives.
* People level: Training, awareness, skills, qualifications, authorization and physical security.
	* Agents that operate the security mechanisms, their actions impact the security of the organization.

**Pillars of Information Security**

* Confidentiality: Component associated with secrecy and the use of encryption, data must be available only to authorized agents. 
	* If information is confidential then it hasn't been compromised by other parties.
	* Data can't be disclosed to people who do not require them or should not have access to them. 
	* Information is organized in a way that only the person that needs the information can have access. 
	* Breaches are commonly through hacking or social engineering. Hashes are the most common way of encryption (one way functions).
* Integrity: Data integrity refers to the certainty that data won't be tampered or degraded during or after submission. 
	* Data must be kept secure from unauthorized modification even if unintentional. 
	* Data could be compromised mainly during upload or transmission or during storage in a database.
* Availability: Information is readily available to authorized users, done by having properly functioning systems, security controls and communication channels.
	* Critical systems (power generation, medical equipment, safety devices) often have extreme availability requirements (cyber threats, power outagaes, hardware failures and other events).

Information security can therefore be defined as the protection of confidentiality, integrity and availability of the assets by integrating security systems based on people, processes and technology.

**Cybersecurity Attributes**

* Authenticity: Property of data or system of being genuine and being able to be verified and trusted in transmission, data and storage.
* Nonrepudiation: Property of data or system of assurance that another agent can't deny you authenticity, nonrepudiation is the ability to ensure that communication cannot deny the authenticity of their signature on a document or message.
* Privacy: Property of data or system that assured that an individual can control or influence data related to them from being collected and stored by others.

Cybersecurity is the prevention of damage to, protection of and restoration of computers, electronic systems and information contained therein to ensure availability, integrity, confidentiality, authentication and nonrepudiation. It is a subset of information technology security using CIA for asset protection of cyber and physical systems. Today both terms are used interchangeably.

***

# Threats #

Cyber threat intelligence is information about threats and threat actors that mitigate harmful events, sources include open source, social media, humans, technical and deep web.

* Threat: Active entity or something that can cause damage to a person, system or organization, also called adversarial agent as they oppose the business objectives. It can be natural or human, human threats can be intentional or unintentional, intentional human threats can be random or targeted.
	* Actors: Cyber threat actors are states, groups, individuals with malicious intent aim to take advantage of vulnerabilities, low security awareness and technological developments to gain unauthorized access affecting data, devices, systems and networks.
	* Impact: Measurement of the potential damage in terms of monetary cost, operating cost and asset damages.
	* Risk: Measurement of the probability of a particular threat of exploiting a vulnerability.
* Vulnerability: Flaw or weakness in people, processes or technology that facilitate threats and can be used to attack resulting in damage or losses. 
	* Exploit: Attack on a computer system that takes advantage of a particular vulnerability in the operating system, application or any software code. Generally comes from an intentional human threat.


CONTROL
 Acción, mecanismo, dispositivo o técnica que mitiga, remueve o reduce una vulnerabilidad para reducir los riesgos.
Los controles pueden ser de varios tipos:
	Detección 
	Prevención
	Recuperación
	Mitigación
	Disuasión
	Transferencia



Actors of Cyberthreats

* Nation States with geopolitical motivation
* Cybercriminals with profit motives
* Hacktivists with ideological motives
* Terrorist Groups with ideological violence
* Thrill seekers with satisfaction motives
* Insider Threats with discontent

Types of common security risks or cybersecurity threats

* Malware: Generic term for any malicious software designed to harm or exploit programmable devices, systems or networks. Malware infects a computer and changes how it functions, destroys data or spies on the user, it can spread from one device to another or remain in place only impacting its host.
* Virus: Usually coming as an attachment in an email holding a payload or a malware that will perform a malicious action once the file is opened by the user. For example NATAS, it infected random software, one of the first virus that could replicate.
* Ransomware: Malware that installs itself onto a victim's machine, encrypts their files and demands a ransom to return the data to the user.
* Scareware: Scaring users into thinking that a system has been compromised to convince victims into purchasing a fake solution, it has an important component of social engineering since it sells the solution to a fake problem.
* Worms: Malware designed to copy themselves from device to device as quickly as posible through a security weakness that don't require user interaction.
* Spyware: Malware installed on your computer, usually without your explicit knowledge that captures and transmits personal information and browsing habits to its user, it's designed to monitor every form of communication on the target device.
* Trojans: Malware that camouflages as a harmless application, once up and running they can steal data, crash the device, spy or launch an attack.
* Adware: Usually installed with other harmless programs with unwanted advertisements at users with pop up windows so that the user performs a certain action.
* Phishing: Attack occurs when sending email from seemingly trusted sources in an attempt to grab sensitive information, they combine social engineering and technology. 
* Spear Phishing: Specific type of targeted phishing attack custom made for a particular target, usually uses email spoofing where the information inside the from portion of the email is faked making it look like the email comes from a different sender.
* Man in the Middle (MITM): Attack or breach designed to eavesdrop on the data sent between two people, networks or devices. The attacker positions themselves in the middle of communications, effectively spying on the interaction between systems where there could be less security.
* Distributed Denial of Service DOS or DDOS: Attack designed to overwhelm the resources of a system where it is unable to reply to legitimate service requests, a distributed attack also seeks to drain resources of a system initiated by a vast array of malware infected host machines. The victim is unable to provide the service to its users.
* Backdoor: Point of entry into a user system or computer that bypasses authentication measures, encryption or intrusion detection. With a remote access they can steal information, install further malware or control the processes. Legitimate backdoors are used by software for troubleshooting, updates and maintenance.
* Bots and Botnets: A bot or zombie is an internet connected device that is infected with malware without the owners awareness and can be remotely controled to perform a malicous task. A botnet is an array of bots to perform the same action multiple times.
* Rootkit: Malware to provide a remote actor with a privileged user access, and therefore full control of the device to further modify the software.
* SQL Injection
* Zero Day Explot
* DNS Attack

***

# Cryptography #

* Symmetric Cryptography: Also known as private-key, single-key or secret-key. One to one communication can be intercepted by a middle man from an unsecure channel, the objective is to encrypt the information so that only the authorized parties are able to understand the information. It works by passing the message in plaintext (x) through an encryption function (e) to generate ciphertext (y), the function (e) uses a random Key Generator (K) through a secure channel that is shared with a decryption function (d), using this the attacker would need to intercept the ciphertext (y) and the more much difficult to obtain Key (K).

FALTA TERMINAR DE LAS PRESENTACIONES

***

# Kali Linux #

## Hashcat ##

> The world's fastest password recovery utility.

* Supports 5 modes of attack: brute-force with masks, hybrid dict with masks, association, combination and straight.
* More than 350 [hashing algorithms](https://hashcat.net/hashcat/#features-algos)
* Integrated hardware acceleration and distributed password cracking.
* Unique in-kernel rule engine, free and open source software.
* Uses OpenCL, CUDA, ROCm and Apple Metal compute runtimes.

### FAQ ###

1. Since it is a CLI tool it needs to be executed inside a terminal
2. You can't use it to recover online passwords only to crack server password hashes.
3. If you need a GUI maybe you shouldn't use this type of tools but we recommend [Hashkiller](http://www.hashkiller.co.uk/hashcat-gui.aspx) or [Hashcat.Launcher](https://github.com/s77rt/hashcat.launcher).
4. The official way to *install* it is to simply extract the binary where you need to excecute it.
	1. Install using your packaging system at your own risk (modified or older versions).
5. Update you GPU drivers from your original manufacturer site.
	1. Sometimes an exact version is necessary. Hashcat is incompatible with CUDA-SDK and AMD-APP-SDK.
	2. Use `amdconfig --adapter=all --initial -f` to generate a `xorg.conf` file in AMD with Linux systems.
	3. Note that in WSL the interface to `fglrx` is not yet supported! CPU only in that case.
6. Make sure to install the [correct GPU driver](https://hashcat.net/wiki/doku.php?id=frequently_asked_questions#i_may_have_the_wrong_driver_installed_what_should_i_do) for your system.
7. To save storage you can delete unused GPU kernel files (`sm_xx.xx.ptx` for NVidia or `VLIWx.ptx` for AMD).

### Common Errors ###

1. Error `cuModuleLoad() 209` means that the GPU driver is too old or that the GPU is not yet supported.
2. Error `cuModuleLoad() 301` means you used `7z e` instead of `7z x` to unpack the binary.
3. Error `clGetPlatformIDs() -64` and `clGetPlatformIDs() -1001` means that the AMD driver installation is wrong.
4. Error `clGetPlatformIDs() -1` means that no GPUs were found, there are multiple fixes. 
5. Error `clBuildProgram() -11` means that your driver corrupted the `llvmir` archive structure.
6. Error `clCreateBuffer() -61` means GPU Out of Memory, Max allocation size for hashcat is 256MB per buffer.
7. Error `clEnqueueCopyBuffer() -30` and `cuStreamSynchronize() 702` means that you exceded the maximum number of rules.
8. Error `FanSpeed_Get() -5` and `ADL_Overdrive5_Temperature_Get() s-1` means hashcat couldn't find an OpenCL device.
	1. Sometimes OpenCL device IDs (fan or temperature sensor) can't be mapped into ADL (AMD Display Library).
9. Error `clGetPlatformIDs() -1` means that no GPUs were found, there are multiple fixes. 
10. Error `clEnqueueNDRangeKernel() -4` means that the AMD GPU package driver `deb` has changed unexpectedly.
	1. Fix ``libOpenCL.so.1` by purging `fglrx` and reinstalling `ocl-icd-libopencl1`.
11. Error `Line-length exception` means that the hash file couldn't be parsed or that it couldn't be found.
	1. Check that the hashfile doesn't contain whitespace or add `--username` if it contains `user:hash` format.

### Basic Cracking ###

* If hashcat finishes an attack and doesn't crack the hashes provided it outputs `Status: Exhausted`
* Hashcat mask files `hcmask` are files with custom charsets and masks definitions per line
	* Mask attacks are targeted brute force attacks where you assume certain patterns (last digits are numeric)
	* Most effective when we know the password length, the mask configures the keyspace using placeholders
	* Placeholders can be custom charset variables, [standard charsets](https://hashcat.net/wiki/doku.php?id=mask_attack) or static letters.
	* The syntax is the static letter or `?` followed by a standard charset `l,u,d,s,a` or custom `1,2,3,4`
* Weak hash detection is a feature that notices if there are hashes with empty plaintext (0 Length Passwords)
	* If your hashlist contains millions of salts for this feature to work we have to run a kernel for each one.
	* This increases the startup of hashcat before starting to crack the real passwords.
	* The parameter `--weak-hash-threshold` sets the max unique salt number before deactivating the feature, by default 100.
* Potfile `potfile` are databases that store hashes after they are successfully cracked.
	* This is done to prevent duplicate hashes from being cracked again, specially if you are trying multiple attack types.
	* Also disables guesses for a specific salt if it detects that all hashes bound to that salt are already on the potfile.
	* Save to append data from one potfile into another, they are stored in `profile` directory as `hashcat.potfile`.
* There is no concrete method for identifying a hash algorithm.
	* Some include hash signatures, for example 1 for `md5crypt`, without it algorithms are basically undistinguishable.
	* The best way to identify hashes is to understand their origin and context and make an educated guess.
* The output `Status: Cracked` empty means that the hash is already in the potfile and can be displayed with `--show`
	* To disable crack storage use `--potfile-disable`. To create a custom potfile use `--potfile-path`
	* You can modify how cracked passwords are displayed using `--show` and arguments such as `--username`
* Generally the keyspace is the total number of possible combinations for a specific attack.
	* In hashcat its a special value `--keyspace` used to optimize distributed node cracking.
	* The value is divided into chunks (delimited by `-s` and `-l`) that are tracked by a host base loop and a candidate modifier loop.
	* It calculates the base loop value using the relations between the number of words in dict, rules and masks.
* Various languages use different character encodings, however most hash algorithms are encoding independent.
	* Use `--hex-charset`, `--hex-salt` and `hcchr` files to use a specific encoding for a specific hash list.
	* Another easier solution is to simply convert the wordlists with `iconv`
* You should always try to use a mask attack instead of a brute force attack.
	* Add `--increment` to increase the mask size char by char, `--increment-min` and `--increment-max` define the range of chars.
	* Add `--custom-charset1 MASK` to define a custom charset and use them within the mask.
	* For example: `hashcat -m 0 -a 3 --increment --increment-min 4 --increment-max 6 hash.txt ?a?a?a?a?a?a?a?a`
	* Note that the size of the mask itself takes precedence over the value in `--increment-max`
* To use custom charsets for special ordering you need to disable the markov-chain optimizations `--markov-disable`
* For rule usage generally use `-r rulefile`, used in a straight attack to manipulate a dictionary.
	* Use `-j` or `-k` when manipulating the left or the right side of the input in hybrid attacks.
	* In general you can stack rules (combine them) and they will be applied at the same time. `-r rule1 -r rule2`
	* For example to append and prepend a single numerical digit to every dictionary word we can do this:
	* `hashcat hash.txt wordlist.txt -r rules/hybrid/append_d.rule -r rules/hybrid/prepend_d.rule`
* To use multiple dictionary in a dict attack `-a 0` you can specify them as a space separated list.
	* You can also specify multiple files using globbing `../wordlists/*.dict` or a directory itself `wordlists`.
	* If you have wordlists with duplicates please sort them first `sort -u -o sorted.txt wordlists/*`
* One common password pattern is to simply toggle characters from lower to upper case, we use `rules/toggle1.rule`.
	* Hashcat includes rules for a toggle-case attack if you suspect the password has 1 to 5 characters toggled.
* You can find the performance of your setup using a benchmark `--benchmark`.
	* This generates a single hash and tries to brute force it with a big enough mask for your GPU.
	* Performance varies depending on attack type, number of hashes, salts, keyspace and cracking frequency.
	* You can specify a particular hash algorithm for the benchmark using `--hash-type`
* Hashcat comes with 3 workload profiles that can be changed with `--workload-profile=NUM`
	* Reduced GPU resource usage `1`, default performance `2`, or tuned-high GPU resource usage `3`.
* GPU Power is the amount of base-words per GPU computed in parallel per kernel invocation.
	* GPUP= S (GPU shader value) * T (64 for AMD and 256 for NV) * N (256 default for -w 3) * V (Vector size 1, 2 or 4)
* GPU hardware acceleration needs an appropriate amount of work (amplification) to achieve full speed.
	* For fast hash algorithms the appropriate amount of work is approximately 1000 rules and 10 million words.
	* For slow hash algorithms you won't need amplifiers to keep the GPU busy at the risk of having small wordlist.
	* For slow hash feed hashcat base words directly `hashcat --stdout wordlist.txt -r rules/best64.rule | hashcat -m 2500 test.hccapx`
* If your attack is slow there are many possible reasons:
	* The system hardware is slow, you didn't create enough work for hashcat hardware acceleration.
	* Using reduced performance workload profile, GPUs are overheating, hashlist is to big.
	* Some hashing algorithms are specifically designed to be slow such as `bcrypt`, `scrypt` or `bitcoin wallet`.
* If you get the error `bitmap table overflowed` it means that the hashlist size is to big.
	* For optimization hashcat creates a memory structure (bitmap table) that becomes less efficient with large hashlists.
	* This happens with millions of hashes, you can fix it by increasing the bitmap size or splitting your hashlist.
* You can restore you hashcat session using `--restore` with the appropriate `.restore` file.
* You can interact with hashcat while its running using `outfiles`, `induction` or `loopback`
	* Outfile Check: Use `--outfile-check-dir=FOLDER` and `--outfile-check-timer=NUM` to check continuously at the `session.outfiles` directory for a `hash[:salt]:plain` combinations file generated for example with another hashcat instance using the `--outfile` option into the `*.outfiles` directory. This makes the running process increase the guessing speed by optimizing the current plain. 
	* Induction: Use `--induction-dir` to add new plains that the running instance should use after the current dict has finished.
	* Loopback: Use `--loopback` to reuse plains that cracked a hash to the modified and matching plains (only works if no more plains match).
* You can extract hashes from TrueCrypt and VeraCrypt volumes but you need to extract the correct binary data file.
	* For TrueCrypt Boot Loader v7+ you extract 512 bytes from offset 31744 (Offset may vary for older versions).
	* If TrueCrypt uses a hidden partition you skip the first 64K bytes and extract the next 512 bytes, for example:
	* `dd if=hashcat_ripemd160_AES_hidden.raw of=hashcat_ripemd160_AES_hidden.tc bs=1 skip=65536 count=512`
	* For every other case (simple files, non-booting partitions) simply extract the first 512 bytes.
* The maximum supported password and salt length is 256 characters (pure kernels), for optimized the length is lower.
* You can use most of the Jack the Ripper generated rule files with hashcat, preprocessor being a notable exception.
	* Use the [rule syntax documentation](https://hashcat.net/wiki/doku.php?id=rule_based_attack) to know if they are compatible.
* A typical error is to try to use specific wordlist for specific hash-type targets. Hashcat adapts wordlists automatically.
* Use `echo -n test | md5sum` to create a test hash for hashcat. We add `-n` to delete the newline character.
* For Apache servers with `htpasswd` files use `--username` and the correct hash type `-m`.
	* There are several hashing algorithms including Apache MD5 `apr1`, raw SHA1 `SHA`, DEScrypt, etc.
* You can crack multiple WPA handshakes at once using a single `.hccapx` file.
	* To get the individual networks into a single file use `cat multiple/*.hccapx > allinone/multi.hccapx `
	* It is recommended to use tools such as `cap2hccapx`, `analyze_hccap`, `craft_hccap`, `hccap2cap` to edit the file.



* LM hashes are divided into two parts to optimize hashcat process, you should use `--show` to combine them after cracking.

```sh
cat hash
ec97b64dce94d891299bd128c1101fd6

hashcat -m 3000 -a 3 -w 3 -o cracked.txt --quiet hash ?u?u?u?u?u?u?u
ec97b64dce94d891:AMAZING
299bd128c1101fd6:HASHCAT

hashcat -m 3000 --show --quiet hash
ec97b64dce94d891299bd128c1101fd6:AMAZINGHASHCAT
```

* Hashcat can't and [will not crack SL3](https://hashcat.net/forum/thread-1887.html) Phone (Nokia) hashes.




### Team Hashcat ###

Team of password cracking enthusiast that participate in mayor contests including Korelogic's "Crack Me If You Can" or [CMIYC](https://twitter.com/crackmeifyoucan) that takes place at Defcon, "Hashrunner" at Positive Hack Days and CracktheCon at Cyphercon.





### Install ###

You can install hashcat for a Linux distribution such as Kali using the `apt` commands to interact with the Debian `dpkg` packaging system.

```sh
sudo apt-get update
sudo apt-get upgrade
sudo apt-get install hashcat
hashcat --help
```


* For other linux distributions you can install using the [latest](https://github.com/hashcat/hashcat) binaries (currently v6.2.6 - 2022-09-02).
	* Use `7z x` when unpacking
	* PGP Keyservers: RSA - 2048bit - KEY ID (2048R/8A16544F) - Fingerprint (A708 3322 9D04 0B41 99CC 0052 3C17 DA8B 8A16 544F)
	* To verify the PGP signature download the signing key, download the binary `7z` and signature `asc` and manually check the fingerprint.
  
```sh
gpg --keyserver keys.gnupg.net --recv 8A16544F
wget https://hashcat.net/files/hashcat-VERSION.7z
wget https://hashcat.net/files/hashcat-VERSION.7z.asc
gpg --verify hashcat-VERSION.7z.asc hashcat-VERSION.7z
```



### Tools

* To extract the hashes from OFFICE or PDF files into a hashlist use [office2hashcat.py](https://raw.githubusercontent.com/stricture/hashstack-server-plugin-oclhashcat/master/scrapers/office2hashcat.py) and [pdf2hashcat.py](https://raw.githubusercontent.com/stricture/hashstack-server-plugin-oclhashcat/master/scrapers/pdf2hashcat.py)
* Upload and extract WPA handshakes from `pcap` capture file using [cap2hashcat](https://hashcat.net/cap2hashcat/)
	* You can get capture files using [aircrack-ng](https://aircrack-ng.org/) and wireshark as long as you don't apply filters
* To convert 7z password protected archives to hashes you can use [7z2hashcat](https://github.com/philsmd/7z2hashcat)
* Friendly Chrome based GUI interface with [Hashcat.Launcher](https://github.com/s77rt/hashcat.launcher)



### More Info ###

* [Hashcat Site](https://hashcat.net/hashcat/)
* [Hashcat Wiki](https://hashcat.net/wiki/)
* [Hashcat Forum](https://hashcat.net/forum/)
* [Hashcat Discord](https://discord.gg/HFS523HGBT)
* [Hashcat Twitter](https://twitter.com/hashcat)
* [Hashcat Repository](https://github.com/hashcat/hashcat)
* [HashKiller Lists](https://hashkiller.io/listmanager)
* [Example Hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)


### Steps to crack PDF ###

Used [pdf2hashcat](https://github.com/sighook/pdf2hashcat)

1. Extracted the hash from the pdf file

```sh
python3 pdf2hashcat.py y.pdf | tee hash.txt

$pdf$5*6*256*-1028*1*16*351dc1db314bd985c038ab533c89eeac*127*...447c16
```

2. Used the [example hashes](https://hashcat.net/wiki/doku.php?id=example_hashes) to find the mode 10700
3. Tried using a rule-based dict attack (failed).

```sh
hashcat -m 10700 -a 0 -r best64.rule hash.txt rockyou.txt -O
```

4. Tried using a [mask attack](https://hashcat.net/wiki/doku.php?id=mask_attack) approach with different masks.
5. Left for 30 min trying 6 number password `?d?d?d?d?d?d` mask.

```sh
hashcat -m 10700 -a 3 hash.txt ?d?d?d?d?d?d -O
```

## seclists ##

## Wordlists ##

```sh
sudo updatedb.plocate
locate wordlist
```

## fcrackzip ##

```sh
fcrackzup -u -D -p /usr/share/wordlists/rockyou.txt secret.zip
```

## zip2john ##

```sh
zip2john secret.zip > hash.txt
```

## john ##

```sh
sudo gunzip rockyou.txt
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```


***

## References ##

https://www.enisa.europa.eu/about-enisa/about/es
https://www.ciscopress.com/series/series.asp?ser=2484573
