---
title: Industrial Networks Lab 1
date: '2020-01-02'
tags: ['school', 'networks']
---

This is an overview of the knowledge needed for evaluating, configuring and installing networks in the industry. Configure device networks, field networks and industrial ethernet using PLC's and HMI's. Requires knowledge of industrial networks and automation.

***

1. Problem Identification
	1. Identify situation, problems and tools available
	2. Design a solution that can be presented to the client
2. Investigate Problem
	1. Understand the variables in the problem
	2. Obtain all the information about the variables
	3. Obtain estimate value of the components
3. Use tools and simulations
	1. Select the tools that will be used
	2. Use simulations of the system components
	3. Determine if the solution solves the problem
4. PLC Integration
	1. Architecture of modular and compact PLC's
	2. Programming a PLC (programmable automation)
	3. Peripherals needed for network levels
5. Field Networks
	1. Configure sensor actuator networks
	2. Integrate PLC's into field networks
6. Process Networks
	1. Configure process networks
	2. Integrate PLC's into process networks
7. Industrial Ethernet networks
	1. Configure Industrial Ethernet
	2. Integrate PLC's into Industrial Ethernet
8. Human Machine Interfaces 
	1. Apply HMI to a distributed environment
	2. Configure HMI's with PLC's and software.
9. Component selection
	1. Select sensors, PLC's, actuators, connectors.
	2. Select networks, switches, wiring etc.
10. Integration: Component layout design.
11. Prototype: Solution report and manual.
12. Prototype Generation: Physical implementation.

***

# GRAFCET #

GRAFCET (Graphe Fonctionnel de Commande Etape Transition) is a programming language designed for industrial control systems based around stages and stage transitions. Created in 1977 by AFCET to bring non digital tools like organization charts, organiphase, Girard diagrams, Petri net and others into PC's. Standardized in 1979 by ADESA and internationally in 1992 as CEI1131 and EN61131. For the most part it has been superseded by Ladder Language but it is still a powerful educational and modeling tool.

A process can be sequential or combinational. Combinational systems have outputs that only depend on the inputs, outputs are independent of the initial state and their transfer functions are logical in nature (AND, OR and NOT). In sequential systems outputs are dependent on the inputs and the previous stages stored in memory as *State Variables*. GRAFCET is an automation system abstraction since it doesn't know the specific components the PLC will use, in this abstraction stages represent actions (operation) and transitions represent comparisons (control). GRAFCET stages must be elementary stages meaning that in order to  execute a complex operation (macrostage) you must subdivide its actions into its most elementary operations. Note that you may need to use as many SET-RESET instructions as there are state variables in your process.

![Symbols Used in Grafcet](/static/images/notes/SymbolsGrafcetNetworksLab.png)

Stages by themselves can be considered purely combinational but by interacting through transitions with other stages we can create sequential systems. Transition's logical conditions (boolean algebra) can be as complex as we need in order to continue to the following stage. We can see that each stage has an associated action and each transition has an associated receptive message related to what they will do or compare.

![Example of Graphs](/static/images/notes/ExampleofGraphsNetworksLab.png)

Rules:

1. Each stage has a boolean stage variable Xi (1 or 0).
2. Stages can be active or inactive represented by their stage variable (1 is active).
3. Cold start is the initialization without taking information from memory. All initial stages are activated and other remain inactive.
4. Hot start is the reinitialization taking information from memory meaning that we recover the last known state variables.
5. Non-initial stages will be activated when previous stage is active and transition conditions are met.
6. A transition can be in one of the following states:
	1. Not valid: Immediately preceding or following stage are inactive.
	2. Valid: Immediately preceding or following stage are active but condition is not met.
	3. Passable: Condition has been met and is transferring control to new stage.
	4. Passed: By transferring control the following stage has been activated and the preceding has been deactivated.
7. If there are multiple passable transitions they will transition simultaneously.
8. If a stage is activated (SET) and deactivated (RESET) simultaneously it will prefer to remain active as a safety precaution.

![Example Program](/static/images/notes/CADESIMUSimulationOne.png)

[Download the Example](/static/images/files/GRAFCETSimulation1.cad)

***












































GRAFCET Functional

The GRAFCET diagram of the process in question, representing the succession of stages present in it, indicating next to each one of them the actions to be carried out and, among them, the transition conditions

GRAFCET With sensors and actuators.

It is possible to decide which are the drives destined to execute the different operations (cylinders, motors, valves, etc.) and the sensors (pushbuttons, limit switches, sensors, etc.) destined to supply the receptivities, which allow formulating the operating conditions. transition.
The diagram with sensors and actuators is identical with the Functional Grafcet diagram, but the first one goes into detail on the technology used to implement the automation solution.

Control system design.

Once the control chart that relates all the sensors and actuators present in the process has been obtained, it can be used for the design of the control system by passing the GRAFCET obtained to the programming language in LADDER.
This design process consists of two parts:
The Sequential LADDER.
The Combinational LADDER.

Sequential LADDER

The Sequential LADDER understands the structure of stages and transition conditions that relate them. The method consists of assigning to each stage an internal bit of the PLC that represents the state of the internal variable of this stage, representing whether the stage is active or not through the Set (Latch) and Reset (UnLatch) instructions, determined from the transition conditions indicated in the GRAFCET.
The activation of an internal bit (LATCH) of a stage N takes place when the previous stage or stages are activated and the transition condition between said stages and stage N is fulfilled, as presented in the evolution rules of the GRAFCET.
On the other hand, the deactivation of the internal bit of a stage (UNLATCH) occurs when the subsequent stage or stages are activated. Remembering that the deactivation of a stage must occur as soon as the next stage or stages are activated.

Applying this procedure to each of the stages, the LADDER of the sequential part of the process is obtained

Combinational LADDER

The combinational LADDER comprises all the actions to be executed within each stage, in this phase the actions to be carried out for each stage of the process are designed and the logical scheme is obtained, using the states of the state variables and eventually other additional conditions.
In the example that is being developed, the actions of each stage are very simple because they directly relate an actuator, in some cases they can be as complex as necessary while dealing with purely combinational actions.

Basic Structures of the Grafcet

In the previous example we have dealt with the case of a relatively simple process, with a linear, cyclic structure and without bifurcations. But there are other processes that require more complex structures, in which there are loops, decision-making or simultaneous tasks that must be synchronized. For these cases, GRAFCET has other basic structures from which the diagrams of said processes can be generated.

The three basic structures in GRAFCET, from which all the others can be derived are:
Linear sequence.
Convergence and divergence in «OR» (alternative threads).
Convergence and divergence in "Y" (simultaneous or parallel threads).

When speaking of combinational logic, it is known that any logical function can be expressed by combining the AND, OR, and NOT operations. Well, making a parallel we can say that sequential systems, whatever their complexity, can always be expressed in GRAFCET by means of graphics that only include the three mentioned above as basic structures.
In practice, as seen in the previous section, one begins by describing the processes using very generic functional graphics, with little level of detail, which will almost always be linear, but as the level of detail progresses, the bifurcations, called convergences and divergences in O and Y.

Linear Sequence

The linear sequence is the simplest possible structure and consists of a succession of stages connected consecutively by the lines of evolution and transition conditions, as could be observed in the previous example.
The properties that this structure fulfills are the following:
Within a stretch of linear sequence, only one stage should be active at a given time. In reality, the GRAFCET rules do not formally prevent the possibility that in a linear sequence there may be more than one active stage, but if this happens it usually denotes a design inconsistency. Indeed, the practical implication that two stages are activated simultaneously is that two groups of actions must be executed simultaneously and this has a more appropriate form of representation by "Y" branches, as can be seen below. On the other hand, if in a linear structure several active stages progress at the same time, they can “catch each other” and this could lead to contradictory conditions that one stage must be activated and deactivated at the same time.

A stage is activated when the previous one is activated and the transition conditions between the two are met.
The activation of a stage automatically implies the deactivation of the previous stage.
A linear sequence can be part of a more complex structure.

The linear structure almost always appears at the general description level with macro-stages and also as part of the more complex structures.

DIVERGENCE AND CONVERGENCE IN O.

The divergence and convergence in O, which we will jointly call the O-bifurcation, form a structure in which the following elements exist.

1. A divergence in OR, in which several possible alternative paths or threads are started.
2. A series of alternative paths with a linear macrostructure, although they may contain other more complex structures.
3. One or more confluences in O of said alternative paths, in such a way that the macrostructure must be globally closed.

The structure of divergence and convergence in O is shown in Figure

This structure is intended to represent alternative processes that must be executed depending on certain logical conditions. For example, in a toll barrier, if the amount entered is exact, hand over the ticket and open the barrier, if it is not exact, return change.
Making a simile with computer-like structures, the branch in O corresponds to a structure of the type IF ... THEN ... ELSE.

The path or sub-process that will be followed in each case will depend on the transition conditions that are met from the stage prior to the bifurcation. It is not essential that the threads that start from the same divergence must come together in the same convergence. What will happen in any process is that any divergence implies the existence of a convergence somewhere in the cycle, since, as has been said, the flow graph seen globally must be closed.

The basic properties that the O-branch structure fulfills are the following:

A. From the point of divergence, the process may evolve along different alternative paths, each of which must have its own transition condition.
B. The transition conditions of the various divergence paths must be EXCLUSIVE OF EACH OTHER, so that the process can only progress in each case along one of them.

In reality, the GRAFCET rules do not impose this restriction, but if it is not followed there is an inconsistency. Indeed, if the conditions are not exclusive to each other, it would indicate the possibility of processes that can be started simultaneously if two or more transition conditions are met simultaneously. If this situation is desired, it must be solved using the Y-bifurcation structure, which is discussed later. But if the situation is accidental, this would reveal a lack of specification in such a case, which must be resolved either by imposing additional conditions to avoid simultaneity or by clearly specifying when the process must be exclusive and when simultaneous.

DIVERGENCE AND CONVERGENCE IN Y.
The divergence and convergence in "Y", which we will jointly call the Y-bifurcation, form a structure in which the following elements exist:
1. A divergence in Y in which multiple paths or threads are started that must be started SIMULTANEOUSLY when a certain common transition condition is met.
2. A series of simultaneous paths with a linear macrostructure, although they may contain other more complex structures.
3. One or more Y-confluences of said paths, so that the macrostructure must be globally closed.

The structure of divergence and convergence in Y is shown in Figure

This structure is envisaged to represent processes that start simultaneously, take place independently at different times and condition the continuation of the process as long as they have not finished all of them. As an example we can mention the operation of we have the case of a machining station, with a station for the input and output of parts, another for drilling and the third for threading. All three operations start and work simultaneously, and you cannot continue the process until all three operations or tasks have been completed. As mentioned for the OR branches, it is not essential that the simultaneous threads that start from the same divergence must converge in the same convergence. What is essential is that the graph, viewed globally, be closed.

The properties that meet the convergences and divergences in Y are the following:
A. From the point of divergence, the process will evolve along several paths at the same time, executing several tasks simultaneously.
B. The transition condition to start the simultaneous tasks is unique and common to all of them.
C. At the global graph level, the different paths started as divergence in Y must converge at one or more points of convergence in Y. In other words, the structure must be globally closed and there cannot be open paths, since this would denote situations with no possible way out.

It is also excluded that the paths of a divergence in Y may concur in a convergence in OR. In reality the GRAFCET rules do not explicitly prohibit this situation, but in case of closing a divergence in Y with a convergence in OR, several stages could be activated consecutive lines of a linear structure that was next and this is in disagreement with the rules of evolution of the GRAFCET.
D. Convergence in Y itself imposes a transition condition: all the tasks that converge in it must be finished for the process to continue. Therefore, a convergence Y can be considered for all intents and purposes to be equivalent to a transition. This does not prevent the existence of additional conditions, apart from the convergence itself, as has been assumed in the previous Figure with the Transition conditions T6 and T7.
In the event that these additional conditions do not exist, T6 = 1 or T7 = 1 can also be written to indicate this circumstance. It is common to use this criterion, making the last stages prior to convergence Y simply waiting stages, where no specific task is developed other than waiting for the other tasks that converge in it to finish.

The Sequential LADDER corresponding to the GRAFCET presented in the previous Figure, is developed in the following Figure, in which it can be observed:

The stage prior to a divergence AND should not be deactivated until all subsequent stages have been activated.
The activation of any stage immediately after a divergence depends on the stage immediately preceding being active and on the common transition condition.
The activation of the stage following a Y convergence depends on all the previous stages being active and possibly on some additional condition (T6 or T7 in our example).

FLOW CHART AND GRAFCET DIAGRAMS

It is interesting to establish a comparison between the GRAFCET and the classic flow charts used in computing, highlighting some essential differences that exist between the two, among which are:
A. A flow chart represents a succession of tasks that are executed sequentially at the speed of the processor, while a GRAFCET is a succession of tasks, eventually controlled by a processor, but that are executed at the speed imposed by the process. In general, then, during the uptime of a GRAFCET stage the processor executes many sweeps of the complete functional graph.

. A flow chart represents, in general, single-task processes, while in GRAFCET it is perfectly legal to represent simultaneous tasks, as presented in the structure of divergence and convergence in Y. In other words, there is no structure in flow charts to represent parallel processes. To better clarify this concept, it can even be said that the same processor can execute several functional graphics at the same time, which can be related to each other or be completely disjoint. As a consequence of the above, a loop in a flow chart implies that only the part of the program inside the loop is being executed, until the condition that allows it to exit is met, while in GRAFCET the entire program is explored, regardless of whether the transition conditions are met or not.

C. A GRAFCET must separate combinational from sequential actions, whereas in a flow chart there is no such distinction.
D. A flow chart does not contain enough information to deduce from it the program in a unique way, while the GRAFCET allows a direct compilation of the program in LADDER.

WHILE DO OR JUMP FORWARD.
REPEAT UNTIL OR JUMP BACK.

STRUCTURE FOR NEXT.









***

First class project under the European standard:

1. PLC configuration, project creation and communication via MPI.
2. Configuration of sensor-actuator devices in the network.
3. Configuration and programming of decentralized periphery.
4. Configuration and programming of HMI interfaces.
5. Control of motors in decentralized periphery.
6. Supervisory control and data acquisition system via TCP / IP.

Second class project under the American standard:

1. Configuration and programming of the main frame by means of the PLC system.
2. Configuration and programming of HMI interfaces.