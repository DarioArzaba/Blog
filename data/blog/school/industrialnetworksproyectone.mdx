---
title: Industrial Networks Lab 1
date: '2021-08-15'
tags: ['school', 'networks']
---

Evaluating, configuring and installing networks in the industry. Configure device networks, field networks and industrial ethernet using PLC's and HMI's. Requires knowledge of industrial networks and automation.

***

# GRAFCET #

GRAFCET (Graphe Fonctionnel de Commande Etape Transition) is a programming language designed for industrial control systems based around stages and stage transitions. Created in 1977 by AFCET to bring non digital tools like organization charts, organiphase, Girard diagrams, Petri net and others into PC's. Standardized in 1979 by ADESA and internationally in 1992 as CEI1131 and EN61131. For the most part it has been superseded by Ladder Language but it is still a powerful educational and modeling tool.

**Sequential or Combinational**

A process can be sequential or combinational. Combinational systems have outputs that only depend on the inputs, outputs are independent of the initial state and their transfer functions are logical in nature (AND, OR and NOT). In sequential systems outputs are dependent on the inputs and the previous stages stored in memory as *State Variables*. 

**Stages and Transitions**

GRAFCET, as an automation system abstraction, doesn't know the specific system components, it simply knows that stages represent actions (operations) and transitions represent comparisons (control). GRAFCET stages must be elementary, meaning that in order to  execute a complex operation (macrostage) you must subdivide its actions into their fundamental components. Note that you may need to use as many SET-RESET instructions as there are state variables.

![Symbols Used in Grafcet](/static/images/notes/SymbolsGrafcetNetworksLab.png)

Stages by themselves can be considered purely combinational but by interacting through transitions with other stages we can create sequential systems. Transition's logical conditions (boolean algebra) can be as complex as we need them to be in order to continue to the following stage. We can see that each stage has an associated action and each transition has an associated receptive message related to what they will do or compare.

![Example of Graphs](/static/images/notes/ExampleofGraphsNetworksLab.png)

1. Each stage has a boolean stage variable Xi (1 or 0).
2. Stages can be active or inactive represented by their stage variable (1 is active).
3. Cold start is an initialization without taking information from memory, meaning that all initial stages are set to active while the rest remain inactive.
4. Hot start is the reinitialization taking information from memory, meaning that we recover the last known state variables of every stage.
5. Non-initial stages activate when the previous one was active and its transition condition is met.
6. A transition can be in one of the following states:
	1. Not valid: Immediately preceding or following stage are inactive.
	2. Valid: Immediately preceding or following stage are active but condition is not met.
	3. Passable: Condition has been met and is transferring control to new stage.
	4. Passed: By transferring control the following stage has been activated and the preceding has been deactivated.
7. If there are multiple passable transitions they will transition simultaneously.
8. If a stage is activated and deactivated simultaneously it will prefer to remain active.

![Example Program](/static/images/notes/CADESIMUSimulationOne.png)

[Download the Example](/static/images/files/GRAFCETSimulation1.cad)

***

**GRAFCET Design**

![Stages of GRAFCET](/static/images/notes/GrafcetStagesDesignNetworksLab.png)

First we create a functional GRAFCET defining the general succession of actions and conditions, then we create a sensors and actuators GRAFCET where we specify the components that the automata will use. Finally we translate the GRAFCET into a control system using ladder language.

**Control System Design**

![Control Design](/static/images/notes/CombinationalSequentialLadderNetworksLab.png)

The translation can be further divided into the sequential ladder translation and the combinational ladder translation. The sequential ladder consists of assigning each stage an internal bit of the PLC representing its internal variable state of active (SET, LATCH) or inactive (RESET, UNLATCH).  

The activation or latch of the internal bit of a stage N takes place when previous stages are activate, meaning that every transition condition has been fulfilled. Deactivation or unlatch occurs when a subsequent stage is activated. The combinational ladder consists of executing every action needed within each stage, a logical scheme is obtained detailing the states of every state variable and condition. 

**Basic Structures**

To achieve complex structures like loops, decision making and simultaneous tasks we combine three fundamental structures: Linear sequences, convergence and divergence in OR (alternative threads), and convergence and divergence in Y (parallel threads). One usually starts describing a generic functional graph as a linear sequence and later adding bifurcation (OR and Y) as the complexity of the system increases.

![Example Program](/static/images/notes/CADESIMUSimulationTwo.png)

[Download the Example](/static/images/files/GRAFCETSimulation2.cad)

A linear sequence is simplest structure, consisting of a succession of stages interconnected by transitions. Within a linear sequence only one stage should be active at a given time (simultaneous actions must be done as Y branches). A stage is activated when the previous one is active and the transition condition has been met. Activation of a stage implies the deactivation of the previous one.

![OR Bifurcation](/static/images/notes/ORBifurcationNetworksLab.png)

The OR bifurcation is a structure representing a divergence in OR followed by several possible paths or threads that in the end must converge back to the original macrostructure. This structure is intended as alternative processes that can be executed depending on a logical condition. They are analogous to the if, then, else structure, and therefore must be exclusive of each other when nested.

![Example Program](/static/images/notes/CADESIMUSimulationThree.png)

[Download the Example](/static/images/files/GRAFCETSimulation3.cad)

![AND Bifurcation](/static/images/notes/ANDBifurcationNetworksLab.png)

The AND bifurcation is a structure representing a divergence in AND followed by several threads that will start simultaneously when their common transition condition is met. Every thread must converge back into a single one as they continue their execution but this must be synchronized so that no thread is left behind. It must be avoided to converge AND in an OR convergence. Usually the last stages prior to an AND convergence are waiting for other stages to finish their job.

![Bifurcation Relation](/static/images/notes/AdditionalStructuresANDORNetworksLab.png)

Using AND and OR bifurcations we can create complex relations.

***

# Sorting Line #

Virtual model of a sorting line. Composed from a storage tower with conveyor chain, a transport band or conveyor belt (both with unidirectional gear motors), three pistons (bidirectional motors) and four discharging tables. 

1. Piece moved out of the warehouse by a conveyor chain.
2. Chain has a magnetic activation switch (single piece).
3. Identification unit reads code with two magnetic sensors.
4. Code corresponds to number of magnets at the bottom.
5. Chain pushes the piece to the conveyor belt.
6. Piece moves to their corresponding discharging station.
7. Inductive proximity sensor in piston detects arrival.
8. Conveyor belt stops completely.
9. Pushed by an electromechanic piston into their station.
10. Pistons have two limit position sensors (end and start).
11. Station is busy if piece detected by light reflection.
12. Conveyor belt continues moving.
13. Ends if all stations are busy (have a piece).
14. Ends if warehouse is empty (light barrier sensor).

| Piece | Magnets Location | Total magnets | Sensors | 
| :---: | :---: | :---: | :---: |
| Workpiece 1 | 1 upper left | 1 | I10.3(1) I10.4(0) or I10.3(0) I10.4(1) |
| Workpiece 2 | 2 left side | 2 | I10.3(2) I10.4(0) or I10.3(0) I10.4(2) |
| Workpiece 3 | 1 missing lower right | 3 | I10.3(2) I10.4(1) or I10.3(1) I10.4(2) |
| Workpiece 4 | 0 missing | 4 | I10.3(2) I10.4(2)|

This control system has 17 digital inputs and 8 digital outputs. The virtual model can be emulated using a virtual machine within the LabVIEW environment and PLCSim. 

| Address | Name | Description | Type |
| :---: | :---: | :---: | :---: |
| I10.0 | P3inWork | Pusher 3 at work | Mechanical sensor (NO) | 
| I10.1 | P3inHome | Pusher 3 at home | Mechanical sensor (NO) | 
| I10.2 | P3engaged | Pusher 3 engage | Reflective light sensor (NC) | 
| I10.3 | RStation1 | Reading Sensor 1 | Magnetic Sensor (NC) | 
| I10.4 | RStation2 | Reading Sensor 2 | Magnetic Sensor (NC) | 
| I10.5 | Lightbarrier | Piece in Warehouse | Light beam (NO) | 
| I10.6 | inPlace3 | Station 3 busy | Reflective light sensor (NC) | 
| I10.7 | inPlace4 | Station 4 busy | Reflective light sensor (NC) | 
| I11.0 | P1inWork | Pusher 1 at work | Mechanical sensor (NO) | 
| I11.1 | P1inHome | Pusher 1 at home | Mechanical sensor (NO) | 
| I11.2 | P2inWork | Pusher 2 at work | Mechanical sensor (NO) | 
| I11.3 | P2inHome | Pusher 2 at home | Mechanical sensor (NO) | 
| I11.4 | P1engaged | Pusher 1 engage | Reflective light sensor (NC) | 
| I11.5 | P2engaged | Pusher 2 engage | Reflective light sensor (NC) | 
| I11.6 | inPlace1 | Station 1 busy | Reflective light sensor (NC) | 
| I11.7 | inPlace2 | Station 2 busy | Reflective light sensor (NC) | 
| I13.6 | chainMagnet | Conveyor chain | Magnetic Sensor (NC) | 

NO sensors are inactive when pressed or obstructed. NC sensors are active when pressed or obstructed.

| Address | Name | Description | Type |
| :---: | :---: | :---: | :---: |
| Q11.0 | Chain | Conveyor Chain | Motor |
| Q11.1 | Belt | Conveyor Chain | Motor |
| Q11.2 | P1toWork | Pusher 1 to Work | Motor |
| Q11.3 | P1toHome | Pusher 1 to Home | Motor |
| Q11.4 | P2toWork | Pusher 2 to Work | Motor |
| Q11.5 | P2toHome | Pusher 2 to Home | Motor |
| Q11.6 | P3toWork | Pusher 3 to Work | Motor |
| Q11.7 | P4toHome | Pusher 3 to Home | Motor |

Use `Shift` and F1, F2, F3 or F4 to make a piece appear or disappear in the corresponding discharging station. 

***

First class project under the European standard:

1. PLC configuration, project creation and communication via MPI.
2. Configuration of sensor-actuator devices in the network.
3. Configuration and programming of decentralized periphery.
4. Configuration and programming of HMI interfaces.
5. Control of motors in decentralized periphery.
6. Supervisory control and data acquisition system via TCP / IP.

Second class project under the American standard:

1. Configuration and programming of the main frame by means of the PLC system.
2. Configuration and programming of HMI interfaces.